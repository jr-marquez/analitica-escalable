{"cells":[{"cell_type":"code","execution_count":3,"metadata":{"id":"EB-IfPLAgC_G","executionInfo":{"status":"ok","timestamp":1659258546819,"user_tz":-120,"elapsed":1030,"user":{"displayName":"Juan Ramon Marquez","userId":"03757562821428915060"}}},"outputs":[],"source":["import numpy as np\n","import dask.array as da"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"XXik5OiJgC_J","executionInfo":{"status":"ok","timestamp":1659258344056,"user_tz":-120,"elapsed":22934,"user":{"displayName":"Juan Ramon Marquez","userId":"03757562821428915060"}}},"outputs":[],"source":["size_tuple = (18000,18000)\n","np_arr = np.random.randint(10, size=size_tuple)\n","np_arr2 = np.random.randint(10, size=size_tuple)"]},{"cell_type":"markdown","metadata":{"id":"ihEf2y74gC_K"},"source":["## Vamos a ejecutar operaciones complejas sobre estos arrays"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Gbl8HQqbgC_L","executionInfo":{"status":"ok","timestamp":1659258404275,"user_tz":-120,"elapsed":7439,"user":{"displayName":"Juan Ramon Marquez","userId":"03757562821428915060"}},"outputId":"931d3c6c-91d2-4935-8506-69afd9707241"},"outputs":[{"output_type":"stream","name":"stdout","text":["CPU times: user 4.58 s, sys: 2.42 s, total: 7 s\n","Wall time: 7.03 s\n"]},{"output_type":"execute_result","data":{"text/plain":["3933103.2667777776"]},"metadata":{},"execution_count":3}],"source":["%time (((np_arr * 2).T)**2 + np_arr2 + 100).sum(axis=1).mean()"]},{"cell_type":"markdown","metadata":{"id":"20p4RkbPgC_M"},"source":["### Ejecutemos lo mismo con Dask Arrays"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"R9wpFvPOgC_M","executionInfo":{"status":"ok","timestamp":1659258447680,"user_tz":-120,"elapsed":12356,"user":{"displayName":"Juan Ramon Marquez","userId":"03757562821428915060"}}},"outputs":[],"source":["chunks_tuple = (500, 500)\n","da_arr = da.from_array(np_arr, chunks=chunks_tuple)\n","da_arr2 = da.from_array(np_arr2, chunks=chunks_tuple)"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wedxbpUtgC_N","executionInfo":{"status":"ok","timestamp":1659258457609,"user_tz":-120,"elapsed":9935,"user":{"displayName":"Juan Ramon Marquez","userId":"03757562821428915060"}},"outputId":"b0fc538b-df76-40e2-c601-400ccded8764"},"outputs":[{"output_type":"stream","name":"stdout","text":["CPU times: user 10.3 s, sys: 4.27 s, total: 14.5 s\n","Wall time: 9.91 s\n"]},{"output_type":"execute_result","data":{"text/plain":["3933103.2667777776"]},"metadata":{},"execution_count":5}],"source":["%time (((da_arr * 2).T)**2 + da_arr2 + 100).sum(axis=1).mean().compute()"]},{"cell_type":"markdown","metadata":{"id":"TmZGI01wgC_N"},"source":["##  Numpy no va a poder ni cargar los datos"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6l1OJDGygC_O"},"outputs":[],"source":["size_tuple = (50000, 50000)\n","np_arr = np.random.randint(10, size=size_tuple)\n","np_arr2 = np.random.randint(10, size=size_tuple)"]},{"cell_type":"markdown","metadata":{"id":"qzty22AGgC_P"},"source":["## Dask si"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"YXQDiqq1gC_P","executionInfo":{"status":"ok","timestamp":1659258591632,"user_tz":-120,"elapsed":419,"user":{"displayName":"Juan Ramon Marquez","userId":"03757562821428915060"}}},"outputs":[],"source":["chunks_tuple = (5000, 5000)\n","size_tuple = (50000, 50000)\n","\n","da_arr = da.random.randint(10, size=size_tuple,\n","                           chunks=chunks_tuple)\n","da_arr2 = da.random.randint(10, size=size_tuple,\n","                            chunks=chunks_tuple)"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"N1NOne0jgC_Q","executionInfo":{"status":"ok","timestamp":1659258689216,"user_tz":-120,"elapsed":94579,"user":{"displayName":"Juan Ramon Marquez","userId":"03757562821428915060"}},"outputId":"9cb13f40-4e9e-4a52-98b7-c53e7f34a27d"},"outputs":[{"output_type":"stream","name":"stdout","text":["CPU times: user 2min 46s, sys: 1.36 s, total: 2min 47s\n","Wall time: 1min 34s\n"]},{"output_type":"execute_result","data":{"text/plain":["10924851.28862"]},"metadata":{},"execution_count":7}],"source":["%time (((da_arr * 2).T)**2 + da_arr2 + 100).sum(axis=1).mean().compute()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RYjNRnMNgC_Q","outputId":"67bb9fd8-20cf-410d-a2f3-cf9ea5d05522"},"outputs":[{"data":{"text/plain":["20.0"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["da_arr.nbytes/(1024*1024*1024)"]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.1"},"colab":{"name":"Comparaci√≥n de Performance","provenance":[]}},"nbformat":4,"nbformat_minor":0}